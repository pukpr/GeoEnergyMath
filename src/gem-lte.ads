package GEM.LTE is
   -- Laplace's Tidal Equations model for equatorial waves -- Chap 11, Chap 12

   -- Top level holds the main Tidal Constituents and LTE modulation parameters

   -- The year value is close to the Tropical year of 365.24219 days
   -- which accumulates to ~1/2 day error over 100 years
   Year : constant Long_Float := 365.246462;
   Draconic : constant Long_Float := 27.21222082;
   Tropical : constant Long_Float := 27.32166155;
   Anomalistic : constant Long_Float := 27.55454988;

   type Long_Period is
      record
         Period, Amplitude, Phase : Long_Float;
      end record;

   type Long_Periods is array (Positive range <>) of Long_Period;

   type Harmonics is array (Positive range <>) of Long_Float;

   type Modulation is
      record
         Wavenumber, Amplitude, Phase : Long_Float;
      end record;

   type Modulations is array (Integer range <>) of Modulation;

   -- Default values that produce a fit to NINO34 of cc = ~0.83
   -- The period values can be derived from the constants above
   -- but are left as values for easy identification.
   -- Also, the phases are not reduced to within (-PI .. PI)  boundaries

   SemiAnnual : constant := 182.623231; -- days
   Annual : constant := 365.246462;
   ThirdAnnual : constant := 121.748821;
   Msm : constant := 31.81209136;
   Mm_1 : constant := 27.66676713;
   Mm_f : constant := 13.77727494;  -- _f for fortnightly
   Nodical_f : constant := 13.60611041;
   Mf_f : constant := 13.66083077;
   Nodical : constant := 27.21222082;
   Mm : constant := 27.55454988;
   Mf : constant := 27.32166155;
   Mf_prime : constant := 13.63341568;
   Msqm : constant := 7.095810615; -- aka Msq
   Mqm : constant := 6.859402884;  -- Mq
   Mstm : constant := 9.556887401;
   Mfm : constant := 9.132950781;  -- aka Mt
   Mfm_1 : constant := 9.124566355;
   Msf_f : constant := 14.76532679;
   Msm_1 : constant := 27.09267692;
   Msf : constant := 29.53065358;
   Perigee_half : constant := SemiAnnual*8.85;
   Perigee : constant := Annual*8.85;
   Nodal_half : constant := SemiAnnual*18.6;
   Nodal : constant := Annual*18.6;
   Mf_Mfp : constant := 6.82355473;
   Mf_Mf : constant := 6.83041539;
   Mf_Nodical : constant := 6.81670784;
   Msp : constant := 5.643; -- not used
   M357 : constant := 1.0/(1.0/Nodal+1.0/Perigee_half);
   MTDD : constant := 1.0/(1.0/Mf+2.0/Nodical);

   HarmN : constant Harmonics := ( -0.21266421321,  -0.15509208407,   1.31312886964,  -0.00053266212,  -1.16548419879,   0.51167125899,
                                   -0.13597743686,  -0.02813301970,   0.55277056621,  -1.10150531431,  -0.22545107535,   4.01231812485,
                                    1.10924276633,  -1.46526977483,  -0.11913941122,  -0.12579619483,   0.86960566108,   0.21007104225,
                                    0.56678143372,  -2.81451848005,  -1.28756076948,   2.20007536745,  -1.27993500496,  -3.17355408433,
                                    27.42209176044,   1.72481959760,  11.59240870566,  -1.26544936533, -2.50530794765,  -7.97501991921,
                                   -28.83626657268,  -4.66979815405, -14.83293683171,  26.55231198290,  29.51175954559);

   Harm : constant Harmonics := (  -0.21266421321,  -0.15509208407,   1.31312886964,  -0.00053266212,  -1.16548419879,   0.51167125899,
                                   -0.13597743686,  -0.02813301970,   0.55277056621,  -1.10150531431,  -0.22545107535,   4.01231812485,
                                    1.10924276633,  -1.46526977483,  -0.11913941122,  -0.12579619483,   0.86960566108,   0.21007104225,
                                    0.56678143372,  -2.81451848005,  -1.28756076948,   2.20007536745,  -1.27993500496,  -3.17355408433,
                                    27.42209176044,   1.72481959760,  11.59240870566,  -1.26544936533, -2.50530794765,  -7.97501991921,
                                   -28.83626657268,  -4.66979815405, -14.83293683171,  26.55231198290,  29.51175954559,  0.00001,
                                    0.00001,          0.00001,        0.00001,          0.00001,        0.00001,         0.00001,
                                    0.00001,          0.00001,        0.00001,          0.00001,        0.00001,         0.00001,
                                    0.00001,          0.00001,        0.00001,          0.00001,        0.00001,         0.00001,
                                    0.00001,          0.00001,        0.00001,          0.00001,        0.00001,         0.00001,
                                    0.00001,          0.00001,        0.00001,          0.00001,        0.00001,         0.00001,
                                    0.00001,          0.00001,        0.00001,          0.00001,        0.00001,         0.00001,
                                    0.00001,          0.00001,        0.00001,          0.00001,        0.00001,         0.00001,
                                    0.00001,          0.00001,        0.00001,          0.00001,        0.00001,         0.00001,
                                    0.00001,          0.00001,        0.00001,          0.00001,        0.00001,         0.00001,
                                    0.00001,          0.00001,        0.00001,          0.00001,        0.00001,         0.00001,
                                    0.00001,          0.00001,        0.00001,          0.00001,        0.00001,         0.00001,
                                    0.00001,          0.00001,        0.00001,          0.00001,        0.00001,         0.00001,
                                    0.00001,          0.00001,        0.00001,          0.00001,        0.00001,         0.00001,
                                    0.00001,          0.00001,        0.00001,          0.00001,        0.00001,         0.00001,
                                    0.00001,          0.00001,        0.00001,          0.00001,        0.00001,         0.00001
                                  );

   Harm1 : constant Harmonics := (
 -0.21255166184,  -0.15570607952,   1.31323569023,  -0.00060941963,  -1.16664442364,   0.51251509158,
  -0.13180480265,  -0.02874910025,   0.55916936122,  -1.09997889296,  -0.24092411163,   4.00770909113,
   1.08751697937,  -1.63892988048,  -0.00698618157,  -0.12947363308,   0.86876806329,   0.22348038091,
   0.57043605452,  -2.84326913208,  -1.31572291876,   2.20031108932,  -1.23512546926,  -3.62338267431,
  27.63715362897,   1.73893718863,  11.62770061112,  -1.22971462222,  -2.63431265440,  -8.02481048641,
 -28.65850472819,  -4.78304924910, -14.64728464135,  26.86614395925,  31.11940355652,   0.00366627138,
   0.00295129042,   0.01417383273,  -0.00415162382,   0.00344508941,   0.00774913366,   0.01433862970,
  -0.03177140182,   0.01363089740,  -0.04863845673,   0.00639544774,  -0.01527996431,   0.04699567428,
  -0.12173482424,  -0.03382665034,  -0.00361628111,   0.06153460083,  -0.10947639455,   0.14414826958,
   1.12673277281,   0.00593767183,  -0.00122137786,   0.00309572190,   0.03934279426,   0.17904580478,
   0.16259335659,  -0.03746152298,  -0.16901652495,   0.13503568429,  -0.22232597643,  -0.10217662517,
  -0.00599773766,  -0.17874729061,  -0.44461202287,  -0.04133248945,  -0.12464206246,  -0.10207394683,
   0.10815890951,   0.00812069489,  -0.06455336229,  -0.22917602547,  -0.03074950795,   1.62960327550,
  -0.23853772962,   1.26119271871,   0.56776652152,  -0.65224991509,  -1.03673826807,   1.45365572129,
  -0.35420892270,  -3.27231480237,  -0.59148185594,   0.00013762512,  14.29475502734, -18.71144697229,
  -0.37452040676,   0.09604418068,   0.53673971908,  -0.01460333104,   3.16664228224,   6.16640511714,
   0.94570510909,  -1.14379845228,  21.96367261518,   1.17285241021,   5.63456889358,   0.63596414330,
   1.90538286848,  -2.69960376560,  -2.68243905126,  -0.00000000000, -29.03014202435,  -0.52548023670,
 -23.63796198578, -63.96401340074,-552.92450563895, 153.61030555748,  40.21604403158, 829.81677379121,
-1115.76573319723, 513.78365910914,  31.68135025130,  27.97729092262, 544.61199691779,  -0.00000000123,
3201.95898888043, 264.93792922664,-18619.84973367544,-1454.63534315083,-25146.68361035855,2619.99978435747 );


   Harm0 :  Harmonics (1..0);

   LPN : constant Long_Periods := (
                                   (0.0,     0.0, 	0.0),
                                   (Mf,     -0.89389709019, 	0.74828892716), -- tropical monthly
                                   (Mm,      0.31935327979, 	0.00920792455), -- anomalistic monthly
                                   (Nodal,   0.01, 0.1)
                                 );


   LP0 : constant Long_Periods := (
                                   (0.0,     0.0, 	0.0),
                                   (Mf,     -0.89389709019, 	0.74828892716), -- tropical monthly
                                   (Mm,      0.31935327979, 	0.00920792455), -- anomalistic monthly
                                   (Nodical, 0.17929221648,   -0.27792722443),  -- draconic monthly
                                   (Nodal,   0.0001, 1.0),
                                   (Perigee, 0.0001, 1.0)
                                 );

   LP1 : constant Long_Periods :=
((   0.00000000000,   0.00000000000,   0.00000000000),
(  Mf,  -0.89411454145,   0.79940542367),
(  Mm,   0.31919837547,   0.00507462061),
(  Nodical,   0.17936944432,  -0.27637370433),
(  Nodal,   0.37131435859,   1.76637899487),
(  Perigee,   0.00709495192,  -0.29254599245) );

      LP2 : constant Long_Periods :=
((   0.00000000000,   0.00000000000,   0.00000000000),
(  Mf,  -0.89411454145,   0.79940542367),
(  Mf_f,   0.17936944432,  -0.27637370433),
(  Nodal,   0.37131435859,   1.76637899487),
(  Perigee,   0.00709495192,  -0.29254599245) );


   --  LP0 : constant Long_Periods := (
   --                                 (Mf_f, 0.189949387, 	-2.835798758), -- tropical fortnightly
   --                                 (Mm, -0.046842425,	-1.377131938), -- anomalistic monthly
   --                                 (Mf_prime, 0.061011159, 	-1.990250035), -- tropical/draconic nonlinear
   --                                 (Msqm, -0.047886633,	-3.405720189) -- Msqm
   --                                );
   --
   LP : constant Long_Periods := (
                                  (SemiAnnual,	0.018080271, 	-2.077486706), -- semi-annual
                                  (Annual,  0.018078892, 	1.575074188),  -- annual
                                  (Msm, -0.000354105,	-0.097518929), -- lunar evection
                                  (Mm_1, 0.020074647, 	3.666651532),  --
                                  (Mm_f, 0.020116683, 	0.022561926),  -- anomalistic fortnightly
                                  (Nodical_f, -0.028703042,	-1.318646215), -- draconic/nodal fortnightly
                                  (Mf_f, 0.189949387, 	-2.835798758), -- tropical fortnightly
                                  (Nodical, 0.00125881,  	0.412311989),  -- draconic/nodal monthly
                                  (Mm, -0.046842425,	-1.377131938), -- anomalistic monthly
                                  (Mf, 0.000746357, 	0.466946899),  -- tropical monthly
                                  (Mf_prime, 0.061011159, 	-1.990250035), -- tropical/draconic nonlinear
                                  (Msqm, -0.047886633,	-3.405720189), -- Msqm
                                  (Mqm, -0.02248555, 	-17.7200619),  -- Mqm
                                  (Mstm, 0.014018594, 	-7.453951926), -- Mstm
                                  (Mfm, -0.006125104,	-0.03308375),  -- Mfm
                                  (Mfm_1, 0.008314442, 	-0.000163231),
                                  (Msf_f, -0.017749988,	-2.474938943), -- synodic fortnightly
                                  (Msm_1, 0.013887908, 	7.163035366),
                                  (Msf, 0.00000001, 0.9),
                                  (Perigee_half,	  0.0001, 1.0), -- Mf_Mfp Perigee_half
                                  (Perigee,  0.0001, 1.0),
                                  (Nodal_half,	  0.0001, 1.0), -- Nodal_half  Mf_Nodical Nodal_half
                                  (Nodal,  0.0001, 1.0), -- Nodal
                                  (Mf_Mfp,  0.0001, 1.0),
                                  (Mf_Mf,  0.0001, 1.0)
                                 );


   LTM : constant Modulations := (
    (2.763168894,	4.782646953,	-1.531748603),
   (42.38703079, 	4.206881588,	-5.741140747),
   (18.68216048, 	3.581731279,	-4.376886727),
   --  (200.0, 0.01, 1.0),
   --  (600.0, 0.01, 1.0),
   --  (1000.0, 0.01, 1.0),
   --  (2000.0, 0.01, 1.0),
   (6000.0, 	0.01,	1.0),
   (16000.0, 	0.01,	1.0)
                                 );


   LTMH : constant Modulations := (
                                   (668.5760282,	1.349247271,	3.195888048),
                                   (-16.46431638,	5.565707873,	-2.302220728),
                                   (32.44545374,	0.881920853,	0.95067816),
                                   (-134.4506659,	4.084373727,	-0.138863958),
                                   (-7392.835472,	3.980138425,	0.417140339) );

   LTMH1 : constant Modulations :=
(( 667.21973625042,   1.09684904003,   2.50088957264),
(  14.11729735425,   0.57271978606,  -0.47923064097),
( -37.95310926944,   0.52794350504,  -0.15291253208),
(14999.81412663215,   0.66181242488,  -0.40952286423),
 (2071.75131938180,   0.84481938865,  -2.54480041660),
 (-1000.0, 0.01, 0.1),
 (-3000.0, 0.01, 0.1),
 (-134.4506659, 0.01, -0.1),
 (-5000.0, 0.01, 0.1),
 (8000.0, 0.01, 0.1)
 );

   --
   -- Conventional Tidal -- short periods, no modulation
   --

   M2 : constant := 12.4206012/24.0;
   S2 : constant := 12.0000001/24.0; -- not exactly 12 for reason, see Is_Fixed
   N2 : constant := 12.65834751/24.0;
   K1 : constant := 23.93447213/24.0;
   O1 : constant := 25.81933871/24.0;

   SP : constant Long_Periods :=
     (-- SP=Short periods for conventional tidal analysis
      (M2,  0.01, 0.9),   -- Principal lunar semidiurnal M2
      (S2,  0.01, 0.9),   -- Principal solar semidiurnal S2
      (N2, 0.01, 0.9),    -- Larger lunar elliptic semidiurnal N2
      (K1, 0.01, 0.9),    -- Lunar diurnal K1
      (O1, 0.01, 0.9)     -- Lunar diurnal O1
     );

   LT0 :  Modulations (1..0);

end GEM.LTE;

